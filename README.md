# LAA Digital Hackathon - July 2024

## Project `genaitests`

The source code for the Team 4 Hackathon project is split into two top-level
directories to allow concurrent development by the team.

If this were not part of a three-day hackathon, it's likely we'd avoid mixing
a Java Spring Boot web application and a Python script in this way.

## Directory `boot-api`

A Spring Boot web application that serves two purposes:

* `POST /scenario` accepts a `requirements` string array
  and responds with a `scenarios` string array, generated by OpenAI..
* `POST /webhook` accepts a Jira Web Hook notification and runs the
  Python script to handle the hook.

### Configuring the web app

You will need an OpenAI API key to put into `application.properties`
and a free `ngrok` account auth token to be able to expose the web hook.

### Exposing the Jira Web Hook

Jira Cloud can only access Internet-exposed web hook endpoints.

```bash
brew install ngrok/ngrok/ngrok # check ngrok install guide
ngrok config add-authtoken ${NGROK_AUTH_TOKEN}
ngrok http 8080 # expose the app over HTTPS temporarily
```

## Directory `py-jira`

A Python script using the `atlassian-python-api` and the `requests`
packages to talk to Jira and the `/scenario` Spring Boot API to get the Jira
issue description text as the `requirements`, convert these `requirements`
into test `scenarios`, and then append these generated test `scenarios` as
an issue comment on the Jira issue.

### Installing Python requirements

Use a virtual environment to isolate the installed required dependencies.
Note we use a shell script (`runmain`) to invoke the Python file
(`main.py`) so we don't have to start the Spring Boot web app from a shell
which has already activated the virtual environment.

```bash
cd py-jira
python3 -m venv .venv
. .venv/bin/activate
pip install requests atlassian-python-api
chmod +x runmain
```

### Configuring the Python script

At the start of `main.py`, edit the values of the constants `JIRA_URL`,
`USER` and `TOKEN` for your Jira Cloud bot account (`TOKEN` is a revocable
Jira API token, generated for the Jira Cloud user or project, _not_ the bot
account's Jira password).

You should create a new free Jira Cloud workspace, and a dedicated email for
the bot account (e.g. a new GMail account) to keep this entirely separate from
your work accounts.
